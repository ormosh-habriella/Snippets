{% extends 'base.html' %}
{% load static %}
{% load my_tags %}
{#{% load querystring %}#}
{% block style %}
    {{ block.super }}
    <style>
        .fa-solid {
            color: #932e2e;
        }
    </style>
{% endblock %}
{% block content %}
    <!-- Begin page content -->
    <div class="container">
    <div class="row">
        <div class="col text-center">
            <h1>{{ pagename }}</h1>
            <hr>
        </div>
    </div>

    <div class="row">
        <div class="col-4">
            <form action="" method="get">
                <div class="input-group mb-3">
                        <span class="input-group-text">
                            <i class="fas fa-search"></i>
                        </span>
                    <input type="text" name="search" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞...">
                    <button class="btn btn-primary" type="submit" id="button-addon2">Find</button>
                </div>
            </form>

        </div>
    </div>
    <div class="row">
        <div class="col">
            <form action="" method="get">
                <div class="d-flex flex-wrap align-items-end gap-3 mb-3">

                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <label class="form-label mb-0 text-nowrap">
                            <i class="fas fa-code me-1"></i> –Ø–∑—ã–∫:
                        </label>
                        <select class="form-select" name="lang">
                            <option selected value="">–í—Å–µ —è–∑—ã–∫–∏</option>
                            {% for LANG_CHOICE in LANG_CHOICES %}
                                <option {% if lang == LANG_CHOICE.0 %} selected {% endif %}
                                                                       value="{{ LANG_CHOICE.0 }}">
                                    {{ LANG_CHOICE.1 }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="d-flex align-items-center gap-2 flex-grow-1">
                        <label for="authorFilter" class="form-label mb-0 text-nowrap">
                            <i class="fas fa-user me-1"></i> –ê–≤—Ç–æ—Ä:
                        </label>
                        <select class="form-select" name="user_id">
                            <option selected value="">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                            {% for user in users %}
                                <option value="{{ user.id }}">{{ user.username }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div>
                        <button type="submit" class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="row">
    <div class="col">
        <table class="table table-striped">
            <thead class="table-dark">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">{% if sort == 'name' %}
                    {# <a href="?sort=-name">–ù–∞–∑–≤–∞–Ω–∏–µ</a> #}
                    <a href="{% querystring sort='-name' %}">–ù–∞–∑–≤–∞–Ω–∏–µ</a>
                    <i style="color: white" class="fa-solid fa-arrow-up-a-z"></i>
                {% elif sort == '-name' %}
                    <a href="?sort=name">–ù–∞–∑–≤–∞–Ω–∏–µ</a>
                    <i style="color: white" class="fa-solid fa-arrow-up-z-a"></i>
                {% else %}
                    <a href="?sort=name">–ù–∞–∑–≤–∞–Ω–∏–µ</a>
                {% endif %}</th>
                <th scope="col">{% if sort == 'lang' %}
                    <a href="?sort=-lang">–Ø–∑—ã–∫</a>
                    <i style="color: white" class="fa-solid fa-arrow-up-a-z"></i>
                {% elif sort == '-lang' %}
                    {# <a href="?sort=lang">–Ø–∑—ã–∫</a> #}
                    <a href="{% querystring sort='name' %}">–Ø–∑—ã–∫</a>
                    <i style="color: white" class="fa-solid fa-arrow-up-z-a"></i>
                {% else %}
                    {# <a href="?sort=lang">–Ø–∑—ã–∫</a> #}
                    <a href="{% querystring sort='name' %}">–Ø–∑—ã–∫</a>
                {% endif %}</th>
                <th scope="col">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                <th scope="col">–ê–≤—Ç–æ—Ä</th>
            </tr>
            </thead>
            <tbody>
            {% if page_obj.paginator.count > 0 %}
                {% for snippet in page_obj %}
                    <tr>
                        <td scope="row">{{ snippet.id }}</td>

                        <td>
                            <a href={% url 'snippet-detail' snippet.id %}>{{ snippet.name }}</a>
                            <a href="{% url 'snippet-delete' snippet.id %}">
                                <i class="fa-solid fa-trash"></i>
                            </a>
                            <a href="{% url 'snippet-edit' snippet.id %}">
                                <i class="fa-solid fa-pencil"></i>
                            </a>
                        </td>
                        <td>
                            <i class="fa-brands {{ snippet.lang|icon_class }}"></i>
                            {{ snippet.lang }}
                        </td>
                        <td>{{ snippet.creation_date }}</td>
                        <td>
                            {% if snippet.public %}
                                <i class="fa-solid fa-lock-open"></i>
                            {% else %}
                                <i class="fa-solid fa-lock"></i>
                            {% endif %}
                            {{ snippet.user | default:"–ê–Ω–æ–Ω–∏–º" }}
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="5">
                        <div class="alert alert-info text-center mt-4 mb-0">
                            {% if request.GET.search or request.GET.lang or request.GET.user_id %}
                                <h5 class="alert-heading">–°–Ω–∏–ø–ø–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã üòï</h5>
                                <p>–ü–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º –∏/–∏–ª–∏ –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
                                <a href="{% url 'snippets-page' %}" class="btn btn-outline-secondary mt-2">–°–±—Ä–æ—Å–∏—Ç—å
                                    —Ñ–∏–ª—å—Ç—Ä—ã</a>
                            {% else %}
                                <h5 class="alert-heading">–°–Ω–∏–ø–ø–µ—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç üìù</h5>
                                <p>–í—ã –º–æ–∂–µ—Ç–µ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Å–Ω–∏–ø–ø–µ—Ç!</p>
                                <a href="{% url 'add-snippet-page' %}" class="btn btn-primary mt-2">–°–æ–∑–¥–∞—Ç—å
                                    —Å–Ω–∏–ø–ø–µ—Ç</a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endif %}


            </tbody>
        </table>
        <div class="d-flex justify-content-end">
            <i class="text-muted">–í—Å–µ–≥–æ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤: {{ snippets|length }}</i></div>
    </div>

    {# –ë–ª–æ–∫ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ #}
    {% if page_obj.has_other_pages %} {# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã #}
        <nav aria-label="–ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π">
        <ul class="pagination justify-content-center"> {# –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é #}

        {# –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É #}
        <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
            <a class="page-link"
                    {#                                   {% if page_obj.has_previous %}href="?page={{ page_obj.previous_page_number }}"{% endif %}#}
               {% if page_obj.has_previous %}href="{% querystring page=page_obj.previous_page_number %}"{% endif %}
               tabindex="-1" aria-disabled="true">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        </li>

        {# –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü #}
        {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
                <li class="page-item active" aria-current="page">
                    {#                                        <a class="page-link" href="?page={{ num }}">{{ num }}</a>#}
                    <a class="page-link" href="{% querystring page=num %}">{{ num }}</a>

                </li>
            {% else %}
                <li class="page-item">
                    {#                                        <a class="page-link" href="?page={{ num }}">{{ num }}</a>#}
                    <a class="page-link" href="{% querystring page=num %}">{{ num }}</a>
                </li>
            {% endif %}
        {% endfor %}

        {# –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É #}
        <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
        <a class="page-link"
        {#                                   {% if page_obj.has_next %}href="?page={{ page_obj.next_page_number }}"{% endif %}>–°–ª–µ–¥—É—é—â–∞—è</a>#}
        {% if page_obj.has_next %}href="{% querystring page=page_obj.next_page_number %}"{% endif %}>–°–ª–µ–¥—É—é—â–∞—è</a>
                            </li>

                        </ul>
                    </nav>
                {% endif %}
            </div>
        </div>
    </div>

{% endblock %}
